[gd_scene load_steps=17 format=3 uid="uid://bq63l7m02j036"]

[ext_resource type="PackedScene" uid="uid://c6bfb044jd67f" path="res://Subscenes/Characters/Character.tscn" id="1_up7c8"]
[ext_resource type="Script" path="res://Scripts/Characters/Player/PlayerMovementController.cs" id="2_py02u"]
[ext_resource type="Shader" path="res://Shaders/HitFlash.gdshader" id="3_62u1p"]
[ext_resource type="PackedScene" uid="uid://bwafhnyut7l3f" path="res://Subscenes/PostProcessing.tscn" id="3_ri1l6"]
[ext_resource type="Texture2D" uid="uid://cxdd2y6fb4a0y" path="res://Sprites/Characters/SimpleGuy.png" id="4_sph0l"]
[ext_resource type="Script" path="res://Scripts/Characters/Player/PlayerHealthSystem.cs" id="6_b2ybh"]
[ext_resource type="Script" path="res://Scripts/UI/DeathScreen.cs" id="6_mbc2c"]
[ext_resource type="FontFile" uid="uid://l7d6fnllspln" path="res://CustomResources/UI/BlackOpsOne-Regular.ttf" id="6_v64bi"]
[ext_resource type="Material" uid="uid://dgf8nek54rcbk" path="res://Materials/Vignette.tres" id="7_chfch"]
[ext_resource type="AnimationLibrary" uid="uid://bfiktfwaogu1a" path="res://Animations/Character.res" id="10_4tb4a"]
[ext_resource type="AnimationLibrary" uid="uid://cbc2kgqio8nvk" path="res://Animations/Player.res" id="11_88xnr"]

[sub_resource type="ShaderMaterial" id="ShaderMaterial_eo2dv"]
resource_local_to_scene = true
render_priority = 1
shader = ExtResource("3_62u1p")
shader_parameter/value = 0.0
shader_parameter/flash_color = Color(1, 0, 0, 1)
shader_parameter/source_texture = ExtResource("4_sph0l")

[sub_resource type="StyleBoxFlat" id="StyleBoxFlat_w2hkn"]
bg_color = Color(0, 0, 0, 0.588235)

[sub_resource type="LabelSettings" id="LabelSettings_toayu"]
font = ExtResource("6_v64bi")
font_size = 80
font_color = Color(0.635294, 0, 0, 1)

[sub_resource type="StyleBoxFlat" id="StyleBoxFlat_170uy"]
bg_color = Color(0, 0, 0, 1)
border_width_left = 30
border_width_top = 10
border_width_right = 30
border_width_bottom = 10
border_color = Color(0, 0, 0, 1)
corner_radius_top_left = 10
corner_radius_top_right = 10
corner_radius_bottom_right = 10
corner_radius_bottom_left = 10

[sub_resource type="AnimationLibrary" id="AnimationLibrary_fnoll"]

[node name="Character" node_paths=PackedStringArray("m_VisualsPivot", "m_DeathScreen", "m_AnimationPlayer", "HealthSystem") instance=ExtResource("1_up7c8")]
script = ExtResource("2_py02u")
m_MoveSpeed = 1.25
m_VisualsPivot = NodePath("CharacterVisuals")
m_DeathScreen = NodePath("DeathScreen")
m_AnimationPlayer = NodePath("DefaultAnimationPlayer")
HealthSystem = NodePath("HealthSystem")

[node name="BillboardPivot" parent="CharacterVisuals" index="0"]
transform = Transform3D(-4.37114e-08, 0.707107, -0.707107, 0, 0.707107, 0.707107, 1, 3.09086e-08, -3.09086e-08, 0, 0, 0)

[node name="Body" parent="CharacterVisuals/BillboardPivot" index="0"]
material_overlay = SubResource("ShaderMaterial_eo2dv")

[node name="OmniLight3D" type="OmniLight3D" parent="CharacterVisuals/BillboardPivot/Body/MainHandPivot/Object" index="0"]
transform = Transform3D(0.906308, -0.422618, 1.2595e-08, 0.422618, 0.906308, -2.70101e-08, 3.55271e-15, 2.98023e-08, 1, 0.0156366, 0.0563829, 0.037)
light_color = Color(0.878431, 0.47451, 0.129412, 1)
light_size = 0.1
light_specular = 1.0
light_bake_mode = 0
shadow_enabled = true
shadow_reverse_cull_face = true
shadow_opacity = 0.5
omni_range = 10.0
omni_attenuation = 1.5

[node name="Camera3D" type="Camera3D" parent="." index="2"]
transform = Transform3D(-4.37114e-08, 0.707107, -0.707107, 0, 0.707107, 0.707107, 1, 3.09086e-08, -3.09086e-08, -15, 15, 0)
projection = 1
size = 5.0

[node name="PostProcessing" parent="Camera3D" index="0" instance=ExtResource("3_ri1l6")]

[node name="HealthSystem" parent="." index="4"]
script = ExtResource("6_b2ybh")
m_MaxHealth = 5
m_PlayerVignette = ExtResource("7_chfch")
m_HitValueChangeSpeed = 1.0
m_PlayerResetAnimation = "Player/RESET"
m_HitAnimation = "Player/Hitted"
m_DeathAnimation = "Player/Death"

[node name="DeathScreen" type="Panel" parent="." index="5"]
process_mode = 3
visible = false
anchors_preset = 15
anchor_right = 1.0
anchor_bottom = 1.0
grow_horizontal = 2
grow_vertical = 2
theme_override_styles/panel = SubResource("StyleBoxFlat_w2hkn")
script = ExtResource("6_mbc2c")

[node name="Label" type="Label" parent="DeathScreen" index="0"]
layout_mode = 1
anchors_preset = -1
anchor_left = 0.5
anchor_top = 0.25
anchor_right = 0.5
anchor_bottom = 0.4
grow_horizontal = 2
grow_vertical = 2
text = "DEATH"
label_settings = SubResource("LabelSettings_toayu")
horizontal_alignment = 1
vertical_alignment = 1

[node name="Button" type="Button" parent="DeathScreen" index="1"]
layout_mode = 1
anchors_preset = -1
anchor_left = 0.5
anchor_top = 0.5
anchor_right = 0.5
anchor_bottom = 0.5
grow_horizontal = 2
grow_vertical = 2
theme_override_fonts/font = ExtResource("6_v64bi")
theme_override_font_sizes/font_size = 38
theme_override_styles/normal = SubResource("StyleBoxFlat_170uy")
text = "Restart"

[node name="HitboxAnimationPlayer" parent="." index="6"]
libraries = {
"": SubResource("AnimationLibrary_fnoll"),
"Character": ExtResource("10_4tb4a"),
"Player": ExtResource("11_88xnr")
}

[connection signal="button_up" from="DeathScreen/Button" to="DeathScreen" method="Restart"]

[editable path="HealthSystem"]
